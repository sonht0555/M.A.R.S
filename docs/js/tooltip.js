let divall=null;const selectedText=window.getSelection().toString();function updateRangeText(){const t=window.getSelection().toString(),e=window.getSelection().getRangeAt(0).getBoundingClientRect(),n=document.getElementById("divall"),a=window.innerHeight;if(""!==t){if(!n)if(e.right>0){var o=document.createElement("divs");o.classList.add("divall"),o.id="divall",document.body.appendChild(o);var d=document.createElement("divs");d.classList.add("marsContent"),d.id="marsContent",d.textContent="...",o.appendChild(d);var s=document.createElement("divs");s.classList.add("marsFooter"),o.appendChild(s);var c=document.createElement("buttons");c.classList.add("lang"),chrome.storage.sync.get(["lang1st"],(function(t){c.textContent=t.lang1st})),c.id="btn1st",s.appendChild(c);var i=document.createElement("buttons");i.classList.add("lang"),chrome.storage.sync.get(["lang2nd"],(function(t){i.textContent=t.lang2nd})),i.id="btn2nd",s.appendChild(i);var l=document.createElement("buttons");l.classList.add("lang"),chrome.storage.sync.get(["lang3rd"],(function(t){l.textContent=t.lang3rd})),l.id="btn3rd",s.appendChild(l);var r=document.createElement("divs");r.classList.add("load"),r.id="load",s.appendChild(r);var g=document.createElement("divs");g.classList.add("dot1"),r.appendChild(g);var m=document.createElement("divs");m.classList.add("dot1"),r.appendChild(m);var u=document.createElement("divs");u.classList.add("dot1"),r.appendChild(u),DivHeight=document.getElementById("divall"),existingDivHeight=DivHeight.offsetHeight,o.style.left=e.left+"px",e.width<160?o.style.width="auto":o.style.width=e.width+"px",e.bottom>a-existingDivHeight-e.height+window.scrollY?o.style.top=e.top-existingDivHeight-8+window.scrollY+"px":o.style.top=e.bottom+8+window.scrollY+"px"}else console.log("Location could not be determined")}else n&&n.parentNode.removeChild(n)}function applyTranslationTooltip(t){marsContent=document.getElementById("marsContent"),marsContent.textContent=t,chrome.storage.sync.set({translatedText:t},(function(){}))}document.addEventListener("keydown",(function(t){chrome.storage.sync.get(["tookey"],(function(e){const{tookey:n}=e,a=window.getSelection().toString(),o=document.getElementById("divall");if(o)o.parentNode.removeChild(o);else if(t.key===n&&a){t.preventDefault(),chrome.storage.sync.get(["targetLang"],(function(t){const{targetLang:e}=t;e&&(targetLang=e,translateSelectedText(a,targetLang))})),chrome.storage.sync.set({selectedText:a},(function(){})),updateRangeText(),document.getElementById("btn1st").addEventListener("click",(function(){chrome.storage.sync.get(["lang1st"],(function(t){const{lang1st:e}=t;targetLang=e,chrome.storage.sync.set({targetLang:targetLang}),chrome.storage.sync.set({selectedText:a},(function(){})),translateSelectedText(a,targetLang)}))})),document.getElementById("btn2nd").addEventListener("click",(function(){chrome.storage.sync.get(["lang2nd"],(function(t){const{lang2nd:e}=t;targetLang=e,chrome.storage.sync.set({targetLang:targetLang}),chrome.storage.sync.set({selectedText:a},(function(){})),translateSelectedText(a,targetLang)}))})),document.getElementById("btn3rd").addEventListener("click",(function(){chrome.storage.sync.get(["lang3rd"],(function(t){const{lang3rd:e}=t;targetLang=e,chrome.storage.sync.set({targetLang:targetLang}),chrome.storage.sync.set({selectedText:a},(function(){})),translateSelectedText(a,targetLang)}))}));const e=["btn1st","btn2nd","btn3rd"].map((t=>document.getElementById(t)));chrome.storage.sync.get(["activeButton"],(function(t){const e=t.activeButton;if(e){const t=document.getElementById(e);t&&t.classList.add("s1")}})),e.forEach((t=>{t.addEventListener("click",(function(){e.forEach((t=>t.classList.remove("s1"))),t.classList.add("s1"),chrome.storage.sync.set({activeButton:t.id})}))}))}}))})),document.addEventListener("click",(function(t){const e=document.getElementById("divall");e&&!e.contains(t.target)&&e.parentNode.removeChild(e)}));