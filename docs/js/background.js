chrome.commands.onCommand.addListener((e=>{"start-selection"===e&&chrome.tabs.query({active:!0,currentWindow:!0},(e=>{chrome.tabs.sendMessage(e[0].id,{type:"startSelection"})}))})),chrome.runtime.onMessage.addListener(((e,r,o)=>{if("captureVisibleTab"===e.type)return setTimeout((()=>{chrome.tabs.captureVisibleTab(r.tab.windowId,{format:"png"},(function(e){chrome.runtime.lastError?(console.error(chrome.runtime.lastError),o({error:chrome.runtime.lastError})):o({screenshot:e})}))}),100),!0;"openPop"===e.type&&chrome.action.openPopup()}));