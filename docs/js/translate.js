let context=null;function setLoadingCursor(){document.body.style.cursor="wait",setTimeout((()=>{document.body.style.cursor="default"}),500)}function translateSelectedText(t,e,o){chrome.storage.sync.get(["AI"],(function(n){const{AI:s}=n;if(document.getElementById("marsContent")&&(document.getElementById("load").style.opacity="1"),s)chrome.storage.sync.get(["openApi"],(function(n){const s=n.openApi,l={model:"gpt-3.5-turbo",messages:[{role:"assistant",content:`In the context: ${o}, translate to ${e} paragraph of text: ${t}`}],temperature:.7},a={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(l)};fetch("https://api.openai.com/v1/chat/completions",a).then((t=>{if(!t.ok)throw new Error(`Request failed with status ${t.status}`);return document.getElementById("marsContent")&&(document.getElementById("load").style.opacity="0"),t.json()})).then((n=>{const s=n.choices[0].message.content;console.log("Open-AI"),console.log("%cContent%c "+t,"","color: #10B981; font-style: italic;"),console.log("%cTranslated ["+e+"]%c "+s,"","color: #DD5639; font-style: italic;"),setLoadingCursor(),document.getElementById("marsContent")?applyTranslationTooltip(s):(applyTranslation(s),console.log("prompt",o))})).catch((t=>{console.error(t.message)}))}));else{const o="https://translate.googleapis.com/translate_a/single?dt=t&dt=bd&dt=ex&dt=ld&dt=md&dt=qca&dt=rw&dt=rm&dt=ss&dt=t&dt=at&client=gtx&hl="+e+"&sl=auto&tl="+e+"&dj=1&source=bubble";var l=new XMLHttpRequest;l.open("POST",o,!1),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.onload=function(){if(l.status>=200&&l.status<300){const o=JSON.parse(l.responseText).sentences.map((t=>t.trans)).join(" ");console.log("Google-AI"),console.log("%cContent%c "+t,"","color: #10B981; font-style: italic;"),console.log("%cTranslated ["+e+"]%c "+o,"","color: #DD5639; font-style: italic;"),setLoadingCursor(),document.getElementById("marsContent")?applyTranslationTooltip(o):applyTranslation(o)}else console.error("Request failed with status "+l.status);document.getElementById("marsContent")&&(document.getElementById("load").style.opacity="0")},l.onerror=function(){console.error("Request failed"),document.getElementById("marsContent")&&(document.getElementById("load").style.opacity="0")},l.send("q="+encodeURIComponent(t))}}))}